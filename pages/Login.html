<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeBite - Authentication</title>
    <link rel="stylesheet" href="../assets/css/Login-assets/login.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://www.google.com/recaptcha/api.js?render=6Lea4eUrAAAAAM6YBr39uGXeKaq0UEIpNNCm5Sfy"></script>
    <script src="../assets/js/config/quiet-console.js"></script>
</head>
<body>
    <div class="App">
        <div class="login-container">
            <div class="login-card">
                <!-- Logo and Header -->
                <div class="logo-section">
                    <div class="logo-icon">
                        <span>S</span>
                    </div>
                    <h1 class="brand-name">SafeBite</h1>
                    <p class="welcome-text">Welcome back! Please sign in to continue.</p>
                </div>

                <!-- Login Form -->
                <div id="loginView" class="auth-view active">
                    <form class="login-form" id="loginForm">
                        <div class="input-group">
                            <label for="email">Email or Username</label>
                            <div class="input-field">
                                <i class="fas fa-user"></i>
                                <input type="text" id="email" name="email" placeholder="Enter your email or username" required>
                            </div>
                        </div>

                        <div class="input-group">
                            <label for="password">Password</label>
                            <div class="input-field">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="password" name="password" placeholder="Enter your password" required>
                                <button type="button" class="toggle-password" id="togglePassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>

                        <div class="forgot-password">
                            <a href="#" class="forgot-link" onclick="handleNavigation('forgot')">Forgot your password?</a>
                        </div>

                        <button type="submit" class="signin-btn">
                            <span>Sign In</span>
                        </button>
                    </form>

                    <!-- Sign Up Link -->
                    <div class="signup-section">
                        <p>Don't have an account? <a href="#" class="signup-link" onclick="handleNavigation('signup')">Sign up here</a></p>
                    </div>
                </div>

                <!-- Signup Form -->
                <div id="signupView" class="auth-view">
                    <form class="signup-form" id="signupForm">
                        <!-- Stepper -->
                        <div class="stepper">
                            <div class="stepper-item active" data-step="1">
                                <div class="step-counter">1</div>
                                <div class="step-name">Basic</div>
                            </div>
                            <div class="stepper-item" data-step="2">
                                <div class="step-counter">2</div>
                                <div class="step-name">Details</div>
                            </div>
                            <div class="stepper-item" data-step="3">
                                <div class="step-counter">3</div>
                                <div class="step-name">Security</div>
                            </div>
                        </div>

                        <div class="signup-steps">
                            <!-- Step 1: Basic Info -->
                            <div class="step active" data-step="1">
                                <div class="input-group">
                                    <label for="signupFirstName">First Name</label>
                                    <div class="input-field">
                                        <i class="fas fa-user"></i>
                                        <input type="text" id="signupFirstName" name="first_name" placeholder="Enter your first name" required>
                                    </div>
                                </div>

                                <div class="input-group">
                                    <label for="signupLastName">Last Name</label>
                                    <div class="input-field">
                                        <i class="fas fa-user"></i>
                                        <input type="text" id="signupLastName" name="last_name" placeholder="Enter your last name" required>
                                    </div>
                                </div>

                                <div class="input-group">
                                    <label for="signupEmail">Email</label>
                                    <div class="input-field">
                                        <i class="fas fa-envelope"></i>
                                        <input type="email" id="signupEmail" name="email" placeholder="Enter your email" required>
                                    </div>
                                </div>

                                <!-- Email verification controls -->
                                <div class="input-group" id="emailVerificationGroup">
                                    <label for="signupEmailOtp">Email Verification:</label>
                                    <div class="otp-input-container">
                                        <div class="otp-inputs">
                                            <input type="text" class="signup-otp-digit" maxlength="1" data-index="0" required>
                                            <input type="text" class="signup-otp-digit" maxlength="1" data-index="1" required>
                                            <input type="text" class="signup-otp-digit" maxlength="1" data-index="2" required>
                                            <input type="text" class="signup-otp-digit" maxlength="1" data-index="3" required>
                                            <input type="text" class="signup-otp-digit" maxlength="1" data-index="4" required>
                                            <input type="text" class="signup-otp-digit" maxlength="1" data-index="5" required>
                                        </div>
                                        <input type="hidden" id="signupEmailOtp" maxlength="6">
                                    </div>
                                    <div class="verification-row">
                                        <button type="button" id="sendSignupOtpBtn" class="signin-btn" style="position:relative; z-index:10000; pointer-events:auto; cursor:pointer;">
                                            <span>Send Code</span>
                                        </button>
                                        <button type="button" id="verifySignupOtpBtn" class="signin-btn" style="position:relative; z-index:10000; pointer-events:auto; cursor:pointer;">
                                            <span>Verify Email</span>
                                        </button>
                                    </div>
                                    <div id="signupEmailVerifyStatus" style="margin-top:6px; font-size:0.9rem; color:#b0b0b0;"></div>
                                </div>
                            </div>

                            <!-- Step 2: Contact and Tester Type -->
                            <div class="step" data-step="2">
                                <div class="input-group">
                                    <label for="signupContactNumber">Contact Number</label>
                                    <div class="input-field">
                                        <i class="fas fa-phone"></i>
                                        <input type="text" id="signupContactNumber" name="contact_number" placeholder="Enter your contact number">
                                    </div>
                                </div>

                                <div class="input-group">
                                    <label for="signupTesterType">Tester Type</label>
                                    <div class="input-field">
                                        <i class="fas fa-vials"></i>
                                        <select id="signupTesterType" name="tester_type_id">
                                            <option value="" disabled selected>Select Tester Type</option>
                                            <option value="1">Personal Tester</option>
                                            <option value="2">Canteen Tester</option>
                                            <option value="3">Restaurant Tester</option>
                                            <option value="4">Cafeteria Tester</option>
                                            <option value="5">Catering Tester</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Security -->
                            <div class="step" data-step="3">
                                <div class="input-group">
                                    <label for="signupPassword">Password</label>
                                    <div class="input-field">
                                        <i class="fas fa-lock"></i>
                                        <input type="password" id="signupPassword" name="password" placeholder="Create a password" required>
                                        <button type="button" class="toggle-password" id="toggleSignupPassword">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <!-- Password strength bar -->
                                    <div class="password-strength" style="margin-top:10px;">
                                        <div class="strength-label" id="passwordStrengthLabel">Weak</div>
                                        <div class="strength-track">
                                            <div class="strength-bar" id="passwordStrengthBar"></div>
                                        </div>
                                    </div>
                                    <!-- Password requirements checklist -->
                                    <div id="passwordRequirements" style="margin-top:8px; font-size:0.9rem; color:#b0b0b0; line-height:1.4;">
                                        <ul style="list-style:none; padding-left:0; margin:0;">
                                            <li id="req-length">• At least 8 characters</li>
                                            <li id="req-upper">• One uppercase letter (A-Z)</li>
                                            <li id="req-lower">• One lowercase letter (a-z)</li>
                                            <li id="req-number">• One number (0-9)</li>
                                            <li id="req-special">• One special character (!@#$%^&* etc.)</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="input-group">
                                    <label for="confirmPassword">Confirm Password</label>
                                    <div class="input-field">
                                        <i class="fas fa-lock"></i>
                                        <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm your password" required>
                                        <button type="button" class="toggle-password" id="toggleConfirmPassword">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>

                                <!-- Terms and Privacy Policy -->
                                <div class="input-group">
                                    <div class="terms-privacy-container">
                                        <div class="terms-text">
                                            I agree to the 
                                            <a href="#" onclick="openTermsModal()" class="terms-link">Terms and Conditions</a>
                                        </div>
                                    </div>
                                </div>

                                <div class="input-group">
                                    <div class="terms-privacy-container">
                                        <div class="terms-text">
                                            I agree to the 
                                            <a href="#" onclick="openPrivacyModal()" class="terms-link">Privacy Policy</a>
                                        </div>
                                    </div>
                                </div>

                                <!-- Progress Indicator -->
                                <div class="progress-container" style="margin: 10px 0;">
                                    <div class="progress-indicator" style="width: 0%; height: 4px; background: linear-gradient(90deg, #10b981 0%, #059669 100%); border-radius: 2px; transition: width 0.5s ease; position: relative; overflow: hidden;"></div>
                                    <div class="progress-text" style="font-size: 11px; color: #666; text-align: center; margin-top: 5px;">0/2 agreements accepted</div>
                                </div>

                                <!-- reCAPTCHA v3 Status Indicator -->
                                <div class="recaptcha-status-container">
                                    <div class="recaptcha-content">
                                        <div id="recaptcha-icon" class="recaptcha-icon">
                                            <i class="fas fa-shield-alt"></i>
                                        </div>
                                        <div class="recaptcha-info">
                                            <div class="recaptcha-title">
                                                Security Protection
                                            </div>
                                            <div id="recaptcha-status" class="recaptcha-status">
                                                Initializing reCAPTCHA v3...
                                            </div>
                                        </div>
                                        <div id="recaptcha-score" class="recaptcha-score">
                                            Score: --
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step Controls -->
                        <div class="step-controls">
                            <button type="button" id="signupPrevBtn" class="signin-btn" style="display:none; background:#9e9e9e;">
                                <span>Back</span>
                            </button>
                            <button type="button" id="signupNextBtn" class="signin-btn">
                                <span>Next</span>
                            </button>
                            <button type="submit" id="signupSubmitBtn" class="signin-btn" style="display:none;">
                                <span>Create Account</span>
                            </button>
                        </div>
                    </form>

                    <!-- Back to Login Link -->
                    <div class="signup-section">
                        <p>Already have an account? <a href="#" class="signup-link" onclick="handleNavigation('login')">Sign in here</a></p>
                    </div>
                </div>

                <!-- Forgot Password Form -->
                <div id="forgotView" class="auth-view">
                    <form class="forgot-form" id="forgotForm">
                        <div class="input-group">
                            <label for="forgotEmail">Email</label>
                            <div class="input-field">
                                <i class="fas fa-envelope"></i>
                                <input type="email" id="forgotEmail" name="email" placeholder="Enter your email address" required>
                            </div>
                        </div>

                        <button type="submit" class="signin-btn">
                            <span>Send OTP</span>
                        </button>
                    </form>

                    <!-- Back to Login Link -->
                    <div class="signup-section">
                        <p>Remember your password? <a href="#" class="signup-link" onclick="handleNavigation('login')">Sign in here</a></p>
                    </div>
                </div>

                <!-- OTP Verification Form -->
                <div id="otpView" class="auth-view">
                    <div class="otp-header">
                        <h2>Verify Your Identity</h2>
                        <p class="otp-description">We've sent a 6-digit verification code to</p>
                        <p class="otp-email"><span id="otpEmailDisplay"></span></p>
                        <p class="otp-instruction">Please enter the code below to continue</p>
                    </div>
                    
                    <form class="otp-form" id="otpForm">
                        <div class="input-group">
                            <label for="otpCode">Verification Code</label>
                            <div class="otp-input-container">
                                <div class="otp-inputs">
                                    <input type="text" class="otp-digit" maxlength="1" data-index="0" required>
                                    <input type="text" class="otp-digit" maxlength="1" data-index="1" required>
                                    <input type="text" class="otp-digit" maxlength="1" data-index="2" required>
                                    <input type="text" class="otp-digit" maxlength="1" data-index="3" required>
                                    <input type="text" class="otp-digit" maxlength="1" data-index="4" required>
                                    <input type="text" class="otp-digit" maxlength="1" data-index="5" required>
                                </div>
                                <input type="hidden" id="otpCode" name="otp" required>
                            </div>
                        </div>

                        <button type="submit" class="signin-btn">
                            <span>Verify Code</span>
                        </button>
                    </form>

                    <div class="otp-actions">
                        <div class="otp-timer-container">
                            <div class="timer-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <p class="otp-timer">Resend available in <span id="otpTimer">60</span>s</p>
                        </div>
                        <button type="button" class="resend-btn" id="resendOtpBtn" disabled>
                            <i class="fas fa-redo"></i>
                            <span>Resend Code</span>
                        </button>
                    </div>

                    <!-- Back to Login Link -->
                    <div class="signup-section">
                        <p>Remember your password? <a href="#" class="signup-link" onclick="handleNavigation('login')">Sign in here</a></p>
                    </div>
                </div>

                <!-- Reset Password Form -->
                <div id="resetPasswordView" class="auth-view">
                    <div class="reset-header">
                        <h2>Create New Password</h2>
                        <p class="reset-description">Your identity has been verified. Please create a new secure password.</p>
                    </div>
                    
                    <form class="reset-password-form" id="resetPasswordForm">
                        <div class="input-group">
                            <label for="newPassword">New Password</label>
                            <div class="input-field">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="newPassword" name="new_password" placeholder="Create a password" required>
                                <button type="button" class="toggle-password" id="toggleNewPassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <!-- Password strength bar -->
                            <div class="password-strength" style="margin-top:10px;">
                                <div class="strength-label" id="newPasswordStrengthLabel">Weak</div>
                                <div class="strength-track">
                                    <div class="strength-bar" id="newPasswordStrengthBar"></div>
                                </div>
                            </div>
                            <!-- Password requirements checklist -->
                            <div id="newPasswordRequirements" style="margin-top:8px; font-size:0.9rem; color:#b0b0b0; line-height:1.4;">
                                <ul style="list-style:none; padding-left:0; margin:0;">
                                    <li id="new-req-length">• At least 8 characters</li>
                                    <li id="new-req-upper">• One uppercase letter (A-Z)</li>
                                    <li id="new-req-lower">• One lowercase letter (a-z)</li>
                                    <li id="new-req-number">• One number (0-9)</li>
                                    <li id="new-req-special">• One special character (!@#$%^&* etc.)</li>
                                </ul>
                            </div>
                        </div>

                        <div class="input-group">
                            <label for="confirmNewPassword">Confirm New Password</label>
                            <div class="input-field">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="confirmNewPassword" name="confirm_password" placeholder="Confirm your new password" required>
                                <button type="button" class="toggle-password" id="toggleConfirmNewPassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>


                        <button type="submit" class="signin-btn">
                            <span>Update Password</span>
                        </button>
                    </form>

                    <!-- Back to Login Link -->
                    <div class="signup-section">
                        <p>Remember your password? <a href="#" class="signup-link" onclick="handleNavigation('login')">Sign in here</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Toaster for notifications -->
    <div id="toaster" class="toaster"></div>

    <!-- Terms and Conditions Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Terms and Conditions</h2>
                <span class="close" onclick="closeTermsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <h3>1. Acceptance of Terms</h3>
                <p>By accessing and using SafeBite, you accept and agree to be bound by the terms and provision of this agreement.</p>
                
                <h3>2. Use License</h3>
                <p>Permission is granted to temporarily download one copy of SafeBite for personal, non-commercial transitory viewing only.</p>
                
                <h3>3. Disclaimer</h3>
                <p>The materials on SafeBite are provided on an 'as is' basis. SafeBite makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights.</p>
                
                <h3>4. Limitations</h3>
                <p>In no event shall SafeBite or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on SafeBite, even if SafeBite or an authorized representative has been notified orally or in writing of the possibility of such damage.</p>
                
                <h3>5. Accuracy of Materials</h3>
                <p>The materials appearing on SafeBite could include technical, typographical, or photographic errors. SafeBite does not warrant that any of the materials on its website are accurate, complete, or current.</p>
                
                <h3>6. Links</h3>
                <p>SafeBite has not reviewed all of the sites linked to our website and is not responsible for the contents of any such linked site.</p>
                
                <h3>7. Modifications</h3>
                <p>SafeBite may revise these terms of service for its website at any time without notice. By using this website, you are agreeing to be bound by the then current version of these terms of service.</p>
                
                <h3>8. Governing Law</h3>
                <p>These terms and conditions are governed by and construed in accordance with the laws and you irrevocably submit to the exclusive jurisdiction of the courts in that state or location.</p>
            </div>
            <div class="modal-footer">
                <p class="modal-instruction">Please read the terms above before clicking "I Understand"</p>
                <button type="button" class="understand-btn" onclick="acceptTerms()">I Understand</button>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Privacy Policy</h2>
                <span class="close" onclick="closePrivacyModal()">&times;</span>
            </div>
            <div class="modal-body">
                <h3>1. Information We Collect</h3>
                <p>We collect information you provide directly to us, such as when you create an account, use our services, or contact us for support.</p>
                
                <h3>2. How We Use Your Information</h3>
                <p>We use the information we collect to provide, maintain, and improve our services, process transactions, and communicate with you.</p>
                
                <h3>3. Information Sharing</h3>
                <p>We do not sell, trade, or otherwise transfer your personal information to third parties without your consent, except as described in this policy.</p>
                
                <h3>4. Data Security</h3>
                <p>We implement appropriate security measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction.</p>
                
                <h3>5. Cookies and Tracking</h3>
                <p>We use cookies and similar tracking technologies to enhance your experience on our website and analyze usage patterns.</p>
                
                <h3>6. Third-Party Services</h3>
                <p>Our service may contain links to third-party websites. We are not responsible for the privacy practices of these external sites.</p>
                
                <h3>7. Data Retention</h3>
                <p>We retain your personal information for as long as necessary to provide our services and comply with legal obligations.</p>
                
                <h3>8. Your Rights</h3>
                <p>You have the right to access, update, or delete your personal information. You may also opt out of certain communications from us.</p>
                
                <h3>9. Children's Privacy</h3>
                <p>Our services are not intended for children under 13. We do not knowingly collect personal information from children under 13.</p>
                
                <h3>10. Changes to This Policy</h3>
                <p>We may update this privacy policy from time to time. We will notify you of any changes by posting the new policy on this page.</p>
                
                <h3>11. Contact Us</h3>
                <p>If you have any questions about this privacy policy, please contact us through our support channels.</p>
            </div>
            <div class="modal-footer">
                <p class="modal-instruction">Please read the privacy policy above before clicking "I Understand"</p>
                <button type="button" class="understand-btn" onclick="acceptPrivacy()">I Understand</button>
            </div>
        </div>
    </div>

    <!-- Load API configuration first -->
    <script src="../assets/js/config/api-config.js"></script>
    <script src="assets/js/config/error-handler.js"></script>
    <!-- Load login script after API config -->
    <script src="../assets/js/Login/login.js"></script>
    
</body>
</html>
